<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Stockbridge | Sovereign Tier Terminal</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@500;800&family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
    <style>
        body { background: #000; font-family: 'Inter', sans-serif; color: #fff; -webkit-tap-highlight-color: transparent; }
        .sov-card { background: #0a0a0a; border: 1px solid #1a1a1a; border-radius: 4px; border-left: 2px solid #333; }
        .input-box { background: #111; border: 1px solid #222; border-radius: 4px; padding: 12px; width: 100%; color: #3b82f6; font-family: 'JetBrains Mono'; font-size: 18px; outline: none; }
        .input-box:focus { border-color: #3b82f6; }
        .stat-label { font-size: 9px; font-weight: 800; color: #555; text-transform: uppercase; letter-spacing: 0.15em; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .delta-positive { color: #10b981; }
        .attrition-card { border-left-color: #ef4444; background: linear-gradient(90deg, rgba(239, 68, 68, 0.05) 0%, transparent 100%); }
        .equity-card { border-left-color: #3b82f6; background: linear-gradient(90deg, rgba(59, 130, 246, 0.05) 0%, transparent 100%); }
    </style>
</head>
<body class="p-4 pb-20 max-w-lg mx-auto">

    <header class="flex justify-between items-start mb-8 border-b border-white/10 pb-6">
        <div>
            <h1 class="text-xl font-black tracking-tighter uppercase italic">Stockbridge <span class="text-blue-500 font-normal">Sovereign</span></h1>
            <p class="stat-label">Portfolio: iBuildpro Holdings</p>
        </div>
        <div class="text-right">
            <p class="stat-label">Total Payout (B5)</p>
            <p class="text-3xl font-black mono text-white tracking-tighter" id="top-val">£38.4M</p>
        </div>
    </header>

    <div class="grid grid-cols-2 gap-3 mb-6">
        <div class="sov-card p-4 equity-card">
            <p class="stat-label">Baseline Shares</p>
            <p class="text-lg font-black mono">144,092</p>
        </div>
        <div class="sov-card p-4">
            <p class="stat-label">Net ROI</p>
            <p class="text-lg font-black mono text-emerald-500" id="roi-stat">76.8x</p>
        </div>
    </div>

    <section class="sov-card p-5 mb-8">
        <div class="flex justify-between items-center mb-6">
            <span class="stat-label">Holding Attrition vs Growth</span>
            <div class="flex gap-4">
                <span class="text-[8px] font-bold text-slate-600 uppercase">-- Baseline</span>
                <span class="text-[8px] font-bold text-blue-500 uppercase">● Simulated</span>
            </div>
        </div>
        <div class="h-48">
            <canvas id="sovChart"></canvas>
        </div>
    </section>

    <section class="space-y-4 mb-8">
        <div class="flex justify-between items-center px-1">
            <h3 class="stat-label">Deployment Modeling</h3>
            <button onclick="reset()" class="text-[10px] font-black text-slate-600 uppercase">Reset</button>
        </div>
        <div class="sov-card p-5 space-y-6">
            <div>
                <label class="stat-label block mb-2">Seed Allocation (PPS £11.68)</label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-slate-600 font-mono">£</span>
                    <input type="number" id="in-seed" value="0" class="input-box pl-8" placeholder="0">
                </div>
            </div>
            <div>
                <label class="stat-label block mb-2">Bank Allocation (PPS £58.40)</label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-slate-600 font-mono">£</span>
                    <input type="number" id="in-bank" value="0" class="input-box pl-8" placeholder="0">
                </div>
            </div>
        </div>
    </section>

    <section class="space-y-3 mb-10">
        <p class="stat-label px-1 mb-2">Per-Round Position Worth</p>
        <div id="round-cards" class="space-y-3">
            </div>
    </section>

    <section class="space-y-3 mb-12">
        <p class="stat-label px-1 mb-2 text-rose-500">Balance Reduction Ledger (Tranches 1-5)</p>
        <div id="balance-cards" class="space-y-2">
            </div>
    </section>

    <script>
        const initialS = 144092;
        const initialB = 500000;
        const rounds = [
            { name: "Pre-Seed Plus", p: 3.47, fd: 2825331, type: 'equity' },
            { name: "Seed Round", p: 11.68, fd: 3424646, type: 'equity' },
            { name: "Bank Series A", p: 58.40, fd: 4452046, type: 'equity' },
            { name: "Balance Round 1", p: 58.40, fd: 4657571, type: 'balance' },
            { name: "Balance Round 2", p: 96.64, fd: 4761071, type: 'balance' },
            { name: "Balance Round 3", p: 142.77, fd: 4831121, type: 'balance' },
            { name: "Balance Round 4", p: 201.79, fd: 4880661, type: 'balance' },
            { name: "Balance Round 5", p: 266.39, fd: 4918211, type: 'balance' }
        ];

        let chart;

        function refresh() {
            const sCash = parseFloat(document.getElementById('in-seed').value) || 0;
            const bCash = parseFloat(document.getElementById('in-bank').value) || 0;
            const nS = Math.floor(sCash / 11.68);
            const nB = Math.floor(bCash / 58.40);
            const tShares = initialS + nS + nB;
            const tBasis = initialB + sCash + bCash;

            // Global KPI
            const b5 = rounds[7];
            const finalVal = tShares * b5.p;
            document.getElementById('top-val').innerText = "£" + (finalVal/1000000).toFixed(1) + "M";
            document.getElementById('roi-stat').innerText = (finalVal / tBasis).toFixed(1) + "x";

            // Equity Cards (PS, Seed, Bank)
            const roundCont = document.getElementById('round-cards');
            roundCont.innerHTML = '';
            rounds.filter(r => r.type === 'equity').forEach(r => {
                const val = (tShares * r.p).toLocaleString('en-GB', { style: 'currency', currency: 'GBP', maximumFractionDigits: 0 });
                roundCont.innerHTML += `
                    <div class="sov-card p-4 equity-card flex justify-between items-center">
                        <div>
                            <p class="stat-label text-blue-400">${r.name}</p>
                            <p class="text-xs font-bold mono mt-1">PPS £${r.p.toFixed(2)}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-black mono text-white">${val}</p>
                            <p class="text-[9px] font-bold text-slate-500 mono">${((tShares/r.fd)*100).toFixed(2)}% Stake</p>
                        </div>
                    </div>
                `;
            });

            // Balance Cards
            const balCont = document.getElementById('balance-cards');
            balCont.innerHTML = '';
            rounds.filter(r => r.type === 'balance').forEach(r => {
                const val = (tShares * r.p).toLocaleString('en-GB', { style: 'currency', currency: 'GBP', maximumFractionDigits: 0 });
                balCont.innerHTML += `
                    <div class="sov-card p-4 attrition-card flex justify-between items-center">
                        <div>
                            <p class="stat-label text-rose-500">${r.name}</p>
                            <p class="text-[9px] font-bold text-slate-600 mt-1 uppercase">4% Interest Accrual</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-black mono text-white">${val}</p>
                            <p class="text-[9px] font-bold text-rose-800 mono">${((tShares/r.fd)*100).toFixed(2)}% Diluted</p>
                        </div>
                    </div>
                `;
            });

            chart.data.datasets[1].data = rounds.map(r => (tShares / r.fd)*100);
            chart.update();
        }

        function reset() {
            document.getElementById('in-seed').value = 0;
            document.getElementById('in-bank').value = 0;
            refresh();
        }

        const ctx = document.getElementById('sovChart').getContext('2d');
        chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: rounds.map(r => r.name),
                datasets: [
                    {
                        data: rounds.map(r => (initialS / r.fd)*100),
                        borderColor: '#222',
                        borderWidth: 1.5,
                        borderDash: [5, 5],
                        pointRadius: 0,
                        fill: false
                    },
                    {
                        data: [],
                        borderColor: '#3b82f6',
                        borderWidth: 3,
                        pointBackgroundColor: '#fff',
                        tension: 0.1,
                        fill: false
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    x: { grid: { display: false }, ticks: { color: '#333', font: { size: 9, family: 'JetBrains Mono' } } },
                    y: { grid: { color: 'rgba(255,255,255,0.02)' }, ticks: { color: '#333', font: { size: 9, family: 'JetBrains Mono' } } }
                }
            }
        });

        document.getElementById('in-seed').addEventListener('input', refresh);
        document.getElementById('in-bank').addEventListener('input', refresh);
        refresh();
    </script>
</body>
</html>
